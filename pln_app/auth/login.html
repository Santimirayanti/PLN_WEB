<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background: linear-gradient(to right, #1e3a8a, #3b82f6);
        overflow: hidden;
      }
      .particles {
        position: fixed;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: -1;
      }
    </style>
  </head>
  <body class="flex justify-center items-center h-screen">
    <canvas class="particles"></canvas>
    <div class="bg-white p-8 rounded-2xl shadow-xl w-96 text-center">
      <img src="../assets/img/logo_pln.png" alt="Logo PLN" class="mx-auto w-24 mb-6" />
      <h2 class="text-3xl font-bold text-gray-800 mb-4">Masuk ke Akun</h2>
      <p class="text-gray-500 mb-6">Silakan login untuk melanjutkan</p>
      
      <form id="loginForm" class="space-y-4">
        <input
          type="text"
          id="loginUsername"
          class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Username"
          required
        />
        <input
          type="password"
          id="loginPassword"
          class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Password"
          required
        />
        <button
          type="submit"
          class="w-full py-3 bg-blue-500 text-white font-bold rounded-lg hover:bg-blue-600 transition duration-300"
        >
          Login
        </button>
      </form>

      <p id="loginError" class="text-red-500 mt-4 hidden">
        Username atau Password salah!
      </p>
    </div>

    <script>
      document.getElementById("loginForm").addEventListener("submit", function (event) {
        event.preventDefault();
        
        const username = document.getElementById("loginUsername").value.trim();
        const password = document.getElementById("loginPassword").value.trim();
        let users = JSON.parse(localStorage.getItem("users")) || [];
        
        const foundUser = users.find(user => user.username === username && user.password === btoa(password));
        
        if (foundUser) {
          localStorage.setItem("isLoggedIn", "true");
          localStorage.setItem("currentUser", username);
          window.location.href = "../pages/user/home.html";
        } else {
          document.getElementById("loginError").classList.remove("hidden");
        }
      });

      // Particle effect
      const canvas = document.querySelector(".particles");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      let particlesArray = [];

      class Particle {
        constructor() {
          this.x = Math.random() * canvas.width;
          this.y = Math.random() * canvas.height;
          this.size = Math.random() * 3 + 1;
          this.speedX = Math.random() * 1 - 0.5;
          this.speedY = Math.random() * 1 - 0.5;
        }
        update() {
          this.x += this.speedX;
          this.y += this.speedY;
          if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
          if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
        }
        draw() {
          ctx.fillStyle = "rgba(255, 255, 255, 0.7)";
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      function init() {
        particlesArray = [];
        for (let i = 0; i < 100; i++) {
          particlesArray.push(new Particle());
        }
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particlesArray.forEach((particle) => {
          particle.update();
          particle.draw();
        });
        requestAnimationFrame(animate);
      }

      init();
      animate();
    </script>
  </body>
</html>