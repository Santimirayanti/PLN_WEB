<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - PLN Web App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .sidebar-open main {
        margin-left: 20rem;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <header class="bg-white shadow-md py-4 px-6 flex justify-between items-center">
      <button id="menu-toggle" class="text-gray-700 text-2xl">☰</button>
      <img src="../../assets/img/logo_pln.png" alt="PLN Logo" class="w-20" />
    </header>
    
    <aside id="sidebar" class="fixed top-0 left-0 w-64 h-full bg-white shadow-lg p-6 transform -translate-x-full transition-transform duration-300">
      <button id="close-menu" class="text-gray-700 text-xl absolute top-4 right-4">✖</button>
      <nav class="mt-10">
        <a href="home.html" class="block py-3 px-4 text-lg text-[#009DDB] hover:bg-[#8ac8e0] hover:text-white">Dashboard</a>
        <a href="new_project.html" class="block py-3 px-4 text-lg text-[#009DDB] hover:bg-[#8ac8e0] hover:text-white">New Project</a>
        <a href="tracker.html" class="block py-3 px-4 text-lg text-[#009DDB] hover:bg-[#8ac8e0] hover:text-white">Tracker</a>
        <button onclick="window.location.href='../../auth/login.html'" class="block py-3 px-4 w-full text-left text-lg text-red-600 hover:bg-red-400 hover:text-white">Logout</button>
      </nav>
    </aside>
    
    <main id="main-content" class="p-8 transition-all duration-300">
      <h1 class="text-3xl font-bold text-gray-700 mb-6">Dashboard</h1>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="bg-white p-6 rounded-xl shadow-lg">
          <h3 class="text-lg font-semibold text-gray-600">Total Projects</h3>
          <p id="total-projects" class="text-3xl font-bold text-[#009DDB]">0</p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-lg">
          <h3 class="text-lg font-semibold text-gray-600">Completed Projects</h3>
          <p id="completed-projects" class="text-3xl font-bold text-green-500">0</p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-lg">
          <h3 class="text-lg font-semibold text-gray-600">In Progress</h3>
          <p id="in-progress" class="text-3xl font-bold text-yellow-500">0</p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-lg">
          <h3 class="text-lg font-semibold text-gray-600">Need Review</h3>
          <p id="pending-projects" class="text-3xl font-bold text-red-500">0</p>
        </div>
      </div>
      <div class="bg-white p-6 rounded-xl shadow-lg mt-8">
        <h3 class="text-lg font-semibold text-gray-600 text-center">Project Status Overview</h3>
        <div class="flex justify-center mt-6">
          <canvas id="projectChart" class="w-48 h-48"></canvas>
        </div>
      </div>
    </main>
    
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let menuToggle = document.getElementById("menu-toggle");
        let closeMenu = document.getElementById("close-menu");
        let sidebar = document.getElementById("sidebar");
        let mainContent = document.getElementById("main-content");
        
        menuToggle.addEventListener("click", function () {
          sidebar.classList.toggle("-translate-x-full");
          mainContent.classList.toggle("ml-64");
        });

        closeMenu.addEventListener("click", function () {
          sidebar.classList.add("-translate-x-full");
          mainContent.classList.remove("ml-64");
        });

        let projects = JSON.parse(localStorage.getItem("projects")) || [];
        let total = projects.length;
        let completed = projects.filter((p) => p.status === "Selesai").length;
        let inProgress = projects.filter((p) => p.status === "Dalam Progress").length;
        let pending = projects.filter((p) => p.status === "Belum Dimulai").length;

        document.getElementById("total-projects").textContent = total;
        document.getElementById("completed-projects").textContent = completed;
        document.getElementById("in-progress").textContent = inProgress;
        document.getElementById("pending-projects").textContent = pending;

        const ctx = document.getElementById("projectChart").getContext("2d");
        new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: ["Completed", "In Progress", "Need Review"],
            datasets: [
              {
                data: [completed, inProgress, pending],
                backgroundColor: ["#4CAF50", "#FFC107", "#F44336"],
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
          },
        });
      });
    </script>
  </body>
</html>